[gd_scene load_steps=26 format=3 uid="uid://bqnotp4trnq1s"]

[ext_resource type="Script" path="res://Scripts/Level/Dungeon.cs" id="1_nrrue"]
[ext_resource type="PackedScene" uid="uid://dk48k57ophom0" path="res://Scenes/Characters/Player.tscn" id="2_306vf"]
[ext_resource type="PackedScene" uid="uid://dn2mj5b26joea" path="res://Scenes/UI/GameplayUI.tscn" id="2_rl8he"]
[ext_resource type="PackedScene" uid="uid://cweu7bowvqa71" path="res://Scenes/Levels/SpecialRooms/Spawn.tscn" id="3_wps2p"]
[ext_resource type="PackedScene" uid="uid://0awgfexwxjql" path="res://Scenes/Levels/RandomRooms/Cells_E-W.tscn" id="6_ije2x"]
[ext_resource type="Texture2D" uid="uid://dapaqab16x26q" path="res://Art/Characters/Bartender.png" id="7_o7uui"]
[ext_resource type="Script" path="res://Scripts/Characters/NPC/NPCNode.cs" id="7_of2yy"]
[ext_resource type="Texture2D" uid="uid://dsrcqu0gq77cd" path="res://Art/UI/InteractableIndicator.png" id="8_1hqtl"]
[ext_resource type="Resource" uid="uid://bmo7b8akcdern" path="res://Resources/Item/Weapons/Hammer.tres" id="8_tmt10"]
[ext_resource type="Script" path="res://Scripts/Characters/DialogIndicator.cs" id="9_l63hh"]
[ext_resource type="Script" path="res://Scripts/Interactable/InteractableComponent.cs" id="11_cvi78"]
[ext_resource type="Script" path="res://Scripts/StateMachine/StateMachine.cs" id="12_x8lqb"]
[ext_resource type="Script" path="res://Scripts/StateMachine/States/NPC/NPCDialogState.cs" id="13_106tb"]
[ext_resource type="Resource" uid="uid://beqcvyuy67pw6" path="res://Resources/Dialog/Bartender/FirstGreeting.tres" id="14_a4i08"]
[ext_resource type="Resource" uid="uid://cwokc3orhl2vh" path="res://Resources/Dialog/Bartender/Chatter1.tres" id="15_jomfk"]
[ext_resource type="Resource" uid="uid://d03sjtsrv7523" path="res://Resources/Dialog/Bartender/Chatter2.tres" id="16_sss86"]
[ext_resource type="Resource" uid="uid://ba5hnsbc6sjvt" path="res://Resources/Dialog/Bartender/Chatter3.tres" id="17_cvln1"]
[ext_resource type="Resource" uid="uid://bdh0kmw4gukl0" path="res://Resources/Dialog/Bartender/Chatter4.tres" id="18_4712k"]

[sub_resource type="Animation" id="Animation_ix7gw"]
resource_name = "Idle"
loop_mode = 1
tracks/0/type = "bezier"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:scale:x")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"handle_modes": PackedInt32Array(0, 0, 0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0, 0.9, -0.25, 0, 0.25, 0, 1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0, 0.5, 1)
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite:scale:y")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0, 0, 0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0, 0.9, -0.25, 0, 0.25, 0, 1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0, 0.5, 1)
}

[sub_resource type="Animation" id="Animation_digd6"]
length = 0.001
tracks/0/type = "bezier"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:scale:x")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite:scale:y")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_0df0m"]
_data = {
"Idle": SubResource("Animation_ix7gw"),
"RESET": SubResource("Animation_digd6")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_f4evg"]
size = Vector2(9, 12)

[sub_resource type="Animation" id="Animation_tnu13"]
length = 0.001
tracks/0/type = "bezier"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position:x")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(0, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:position:y")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(-22, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}

[sub_resource type="Animation" id="Animation_ssaqn"]
resource_name = "GrowShrink"
loop_mode = 1
tracks/0/type = "bezier"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position:x")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"handle_modes": PackedInt32Array(0, 0, 0),
"points": PackedFloat32Array(0, -0.25, 0, 0.25, 0, 0, -0.25, 0, 0.25, 0, 0, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0, 0.5, 1)
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:position:y")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0, 0, 0),
"points": PackedFloat32Array(-18, -0.25, 0, 0.25, 0, -21, -0.25, 0, 0.25, 0, -18, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0, 0.5, 1)
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_xmiqr"]
_data = {
"RESET": SubResource("Animation_tnu13"),
"UpDown": SubResource("Animation_ssaqn")
}

[node name="TestLevel" type="Node2D"]
script = ExtResource("1_nrrue")

[node name="GameplayUI" parent="." instance=ExtResource("2_rl8he")]

[node name="Room" parent="." instance=ExtResource("3_wps2p")]

[node name="Player" parent="." instance=ExtResource("2_306vf")]
unique_name_in_owner = true
position = Vector2(184, 121)
collision_mask = 9
StartingWeapon = ExtResource("8_tmt10")

[node name="Cells" parent="." instance=ExtResource("6_ije2x")]
position = Vector2(0, 449)
IsNorthConnection = true

[node name="NPC" type="CharacterBody2D" parent="."]
position = Vector2(100, 113)
collision_layer = 9
collision_mask = 9
script = ExtResource("7_of2yy")

[node name="Sprite" type="Sprite2D" parent="NPC"]
texture = ExtResource("7_o7uui")
offset = Vector2(0, -8)

[node name="AnimationPlayer" type="AnimationPlayer" parent="NPC/Sprite"]
root_node = NodePath("../..")
libraries = {
"": SubResource("AnimationLibrary_0df0m")
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="NPC"]
position = Vector2(0, -6)
shape = SubResource("RectangleShape2D_f4evg")

[node name="DialogIndicator" type="Sprite2D" parent="NPC"]
position = Vector2(0, -22)
texture = ExtResource("8_1hqtl")
script = ExtResource("9_l63hh")

[node name="AnimationPlayer" type="AnimationPlayer" parent="NPC/DialogIndicator"]
libraries = {
"": SubResource("AnimationLibrary_xmiqr")
}

[node name="InteractableComponent" type="Node" parent="NPC"]
script = ExtResource("11_cvi78")

[node name="DialogStateMachine" type="Node" parent="NPC"]
script = ExtResource("12_x8lqb")
InitialState = NodePath("FirstGreetings")

[node name="FirstGreetings" type="Node" parent="NPC/DialogStateMachine"]
script = ExtResource("13_106tb")
DialogResources = [ExtResource("14_a4i08")]

[node name="RandomChatter" type="Node" parent="NPC/DialogStateMachine"]
script = ExtResource("13_106tb")
DialogResources = [ExtResource("15_jomfk"), ExtResource("16_sss86"), ExtResource("17_cvln1"), ExtResource("18_4712k")]

[connection signal="ChangedWeapon" from="Player" to="GameplayUI" method="_on_player_changed_weapon"]
[connection signal="InventoryUpdated" from="Player" to="GameplayUI" method="_on_player_inventory_updated"]
[connection signal="visibility_changed" from="NPC/DialogIndicator" to="NPC/DialogIndicator" method="_on_visibility_changed"]
[connection signal="Interacted" from="NPC/InteractableComponent" to="NPC" method="_on_interactable_component_interacted"]
